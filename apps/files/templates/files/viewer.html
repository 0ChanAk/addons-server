{% extends "files/base.html" %}

{% block bodyclass %}inverse{% endblock %}

{% block content %}
<h3>
    <a href="{{ file_url }}">{{ addon.name }} {{ version }}</a>
    {% if file.platform.id != amo.PLATFORM_ALL.id %}({{ file.platform }}){% endif %}
</h3>
<ol class="breadcrumbs">
    <li>{{ addon.name }}</li>
    <li>{{ version }}</li>
    <li id="breadcrumb">{{ selected['filename'] }}</li>
</ol>
<div id="file-viewer" class="featured">
    <div class="featured-inner">
        {% if not status %}
            <p class="waiting" id="extracting" data-url="{{ poll_url }}">
                {{ _('Add-on file being processed, please wait.') }}
            </p>
        {% endif %}
        <div id="files">
            {% if files %}
                {{ file_tree(files, selected) }}
            {% endif %}
            {% if files %}
            <p id="commands">
                <code>j</code> <a href="#" id="files-prev">{{ _('Previous file') }}</a><br/>
                <code>k</code> <a href="#" id="files-next">{{ _('Next file') }}</a><br/>
                <code>e</code> <a href="#" id="files-expand-all">{{ _('Expand all') }}</a><br/>
                <code>h</code> <a href="#" id="files-hide">{{ _('Hide or unhide tree') }}</a><br/>
                <code>w</code> <a href="#" id="files-wrap">{{ _('Wrap or unwrap text') }}</a>
            </p>
            {% elif not files and status %}
                <p>{{ _('No files in the uploaded file.') }}</p>
            {% endif %}
        </div>
        <div id="thinking" class="hidden">
            <p class="waiting">
                {{ _('Fetching file.') }}
            </p>
        </div>
        <div id="content-wrapper">
            {% if msg %}
                <p>{{ msg }}</p>
            {% endif %}
            <div>
            {% if viewer %}
                {% if selected['binary'] and not selected['directory'] %}
                    {% include "files/file.html" %}
                {% else %}
                    {% if selected and content %}
                        <pre id="content" class="wrapped">{{ content }}</pre>
                    {% elif content == '' %}
                        <p>{{ _('No content.') }}</p>
                    {% endif %}
                {% endif %}
            {% endif %}
            {% if diff %}
                {% if diff.is_diffable() %}
                    <p>
                    {% if diff.is_different() %}
                        {{ _('Files are different.') }}<br/>
                      {% else %}
                        {{ _('Files are the same.') }}<br/>
                    {% endif %}
                    </p>
                {% endif %}
                {% if diff.is_binary() %}
                    {% with selected = diff.one, file = diff.file_one.file %}
                        {% include "files/file.html" %}
                    {% endwith %}
                    {% with selected = diff.two, file = diff.file_two.file %}
                        {% include "files/file.html" %}
                    {% endwith %}
                {% else %}
                    {% if text_one and text_two %}
                        <pre id="diff" class="wrapped hidden"></pre>
                        <pre class="left hidden">{{ text_one }}</pre>
                        <pre class="right hidden">{{ text_two }}</pre>
                    {% endif %}
                {% endif %}
            {% endif %}
            </div>
        </div>
    </div>
</div>

{% endblock %}
