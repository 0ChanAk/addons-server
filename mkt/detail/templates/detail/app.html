{% extends 'mkt/base.html' %}

{% block title %}{{ mkt_page_title(product.name) }}{% endblock %}

{# Breadcrumbs show just one category for now. #}
{% set cats = product.all_categories %}
{% set first_cat = cats[0] if cats else None %}

{% block content %}
  <section class="crumb full">
    <div>
      {% if first_cat %}
        {{ mkt_breadcrumbs(items=[(url('home'), _('Home')),
                                  (first_cat.get_url_path(), first_cat),
                                  (None, product.name)]) }}
      {% else %}
        {{ mkt_breadcrumbs(product=product) }}
      {% endif %}
    </div>
  </section>
  <section class="product-details">
    <div class="visual">
      <img class="icon" src="{{ product.get_icon_url(64) }}" />
    </div>
    <div class="vitals">
      <h2>{{ product.name }}</h2>
      <h3 class="authors">{{ users_list(product.listed_authors) }}</h3>
      <p class="downloads">
        {% trans cnt=product.weekly_downloads,
                 num=product.weekly_downloads|numberfmt %}
          {{ num }} weekly download
        {% pluralize %}
          {{ num }} weekly downloads
        {% endtrans %}
      </p>
      {{ device_list(product) }}
      <a href="{{ product.get_detail_url('privacy') }}">
        {{ _('Privacy Policy') }}</a>
      {% set categories = product.all_categories %}
      {% if categories %}
        <h3>{{ _('Categories') }}</h3>
        <ul class="categories">
          {% for category in categories %}
          <li>
            <a href="{{ category.get_url_path() }}">
              {{ category }}
            </a>
          </li>
          {% endfor %}
        </ul>
      {% endif %}
      {% if product.support_email %}
        {{ emaillink(product.support_email.localized_string,
                     _('Support Email')) }}
      {% endif %}
      {% if product.support_url %}
        <a href="{{ product.support_url|external_url }}">
          {{ _('Support Site') }}</a>
      {% endif %}
    </div>
    <div class="actions">
      {{ market_button(product) }}
      {% if request.check_ownership(product, require_owner=False) %}
        <p><a href="{{ product.get_dev_url() }}" class="button developer manage">
          {{ _('Manage') }}</a></p>
      {% endif %}
    </div>
  </section>
  <section class="description">
    <p>{{ product.description }}</p>
  </section>

  {% if product.all_previews|length %}
    <section class="previews slider full">
      <ul class="content">
        {%- for preview in product.all_previews -%}
          <li>
            <a class="screenshot thumbnail"
               href="{{ preview.image_url }}" title="{{ preview.caption }}">
              <img src="{{ preview.thumbnail_url }}">
            </a>
          </li>
        {%- endfor -%}
      </ul>
    </section>
  {% endif %}
{% endblock %}
